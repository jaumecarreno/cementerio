from __future__ import annotations

from flask import session

SUPPORTED_LANGS = {"es", "ca"}

I18N: dict[str, dict[str, str]] = {
    "menu.home": {"es": "Dashboard", "ca": "Dashboard"},
    "menu.dashboard": {"es": "DASHBOARD", "ca": "DASHBOARD"},
    "menu.funeral_services": {"es": "Servicios funerarios", "ca": "Serveis funeraris"},
    "menu.crematorium": {"es": "Crematorio", "ca": "Crematori"},
    "menu.cemetery": {"es": "Cementerio", "ca": "Cementiri"},
    "menu.billing": {"es": "Facturaci\u00f3n", "ca": "Facturaci\u00f3"},
    "menu.inventory": {"es": "Inventario", "ca": "Inventari"},
    "menu.reports": {"es": "Informes", "ca": "Informes"},
    "menu.reporting": {"es": "Informes", "ca": "Informes"},
    "menu.settings": {"es": "Configuraci\u00f3n", "ca": "Configuraci\u00f3"},
    "menu.logout": {"es": "Cerrar sesi\u00f3n", "ca": "Tancar sessi\u00f3"},
    "cem.panel": {"es": "Panel", "ca": "Panell"},
    "cem.graves": {"es": "Sepulturas", "ca": "Sepultures"},
    "cem.fees": {"es": "Tasas", "ca": "Taxes"},
    "cem.cases": {"es": "Expedientes", "ca": "Expedients"},
    "cem.ownership": {"es": "Titularidad", "ca": "Titularitat"},
    "cem.people": {"es": "Personas", "ca": "Persones"},
    "cem.reports": {"es": "Informes", "ca": "Informes"},
    "cem.engraving": {"es": "L\u00e1pidas/inscripciones", "ca": "L\u00e0pides/inscripcions"},
    "cem.rights": {"es": "Derechos funerarios", "ca": "Drets funeraris"},
    "theme.to_light": {"es": "Modo claro", "ca": "Mode clar"},
    "theme.to_dark": {"es": "Modo oscuro", "ca": "Mode fosc"},
    "common.search": {"es": "Buscar", "ca": "Cercar"},
    "common.clear": {"es": "Limpiar", "ca": "Netejar"},
    "common.apply": {"es": "Aplicar", "ca": "Aplicar"},
    "common.total": {"es": "Total", "ca": "Total"},
    "common.page": {"es": "P\u00e1gina", "ca": "P\u00e0gina"},
    "common.previous": {"es": "Anterior", "ca": "Anterior"},
    "common.next": {"es": "Siguiente", "ca": "Seg\u00fcent"},
    "common.back_to_dashboard": {"es": "Volver al dashboard", "ca": "Tornar al dashboard"},
    "common.module": {"es": "M\u00f3dulo", "ca": "M\u00f2dul"},
    "common.tracking": {"es": "Tracking", "ca": "Tracking"},
    "common.actions": {"es": "Acciones", "ca": "Accions"},
    "common.no_results": {"es": "Sin resultados", "ca": "Sense resultats"},
    "common.id": {"es": "Id", "ca": "Id"},
    "field.name": {"es": "Nombre", "ca": "Nom"},
    "field.last_name": {"es": "Apellidos", "ca": "Cognoms"},
    "field.dni_nif": {"es": "DNI/NIF", "ca": "DNI/NIF"},
    "field.phone": {"es": "Tel\u00e9fono", "ca": "Tel\u00e8fon"},
    "field.email": {"es": "Email", "ca": "Email"},
    "field.address": {"es": "Direcci\u00f3n", "ca": "Adre\u00e7a"},
    "field.notes": {"es": "Notas", "ca": "Notes"},
    "action.new_inhumation": {"es": "Nueva inhumaci\u00f3n", "ca": "Nova inhumaci\u00f3"},
    "action.new_exhumation": {"es": "Nueva exhumaci\u00f3n", "ca": "Nova exhumaci\u00f3"},
    "action.generate_yearly_tickets": {
        "es": "Generar tiquets anuales",
        "ca": "Generar tiquets anuals",
    },
    "action.search_grave": {"es": "Buscar sepultura", "ca": "Cercar sepultura"},
    "action.collect_fees": {"es": "Cobrar tasas", "ca": "Cobrar taxes"},
    "action.mass_create": {"es": "Alta masiva", "ca": "Alta massiva"},
    "dashboard.recent_activity": {"es": "Actividad reciente", "ca": "Activitat recent"},
    "dashboard.no_recent_activity": {"es": "Sin actividad reciente", "ca": "Sense activitat recent"},
    "dashboard.change": {"es": "Cambio", "ca": "Canvi"},
    "dashboard.date": {"es": "Fecha", "ca": "Data"},
    "dashboard.detail": {"es": "Detalle", "ca": "Detall"},
    "dashboard.open_cases": {"es": "Expedientes abiertos", "ca": "Expedients oberts"},
    "dashboard.pending_work_orders": {"es": "OT pendientes", "ca": "OT pendents"},
    "dashboard.unpaid_tickets": {"es": "Tiquets impagados", "ca": "Tiquets impagats"},
    "dashboard.pending_notify": {"es": "Pend. notificar", "ca": "Pend. notificar"},
    "dashboard.recent_cases": {"es": "Expedientes recientes", "ca": "Expedients recents"},
    "dashboard.alerts": {"es": "Alertas", "ca": "Alertes"},
    "dashboard.quick_actions": {"es": "Accesos r\u00e1pidos", "ca": "Accessos r\u00e0pids"},
    "dashboard.case_number": {"es": "N\u00ba", "ca": "N\u00fam."},
    "dashboard.deceased": {"es": "Difunto", "ca": "Difunt"},
    "dashboard.state": {"es": "Estado", "ca": "Estat"},
    "dashboard.no_holder": {"es": "Sin titular", "ca": "Sense titular"},
    "dashboard.grave_ref": {"es": "Sepultura #{id}", "ca": "Sepultura #{id}"},
    "dashboard.alert.pending_tickets": {
        "es": "Hay tiquets de contribuci\u00f3n pendientes (no facturados): {count}",
        "ca": "Hi ha tiquets de contribuci\u00f3 pendents (no facturats): {count}",
    },
    "dashboard.alert.pending_lateral": {
        "es": "Inscripciones laterales en estado pendiente de colocar: {count}",
        "ca": "Inscripcions laterals en estat pendent de col\u00b7locar: {count}",
    },
    "dashboard.alert.lliures": {
        "es": "Sepulturas en estado Lliure pendientes de revisi\u00f3n/vaciado: {count}",
        "ca": "Sepultures en estat Lliure pendents de revisi\u00f3/buidat: {count}",
    },
    "dashboard.alert.none": {"es": "Sin alertas activas", "ca": "Sense alertes actives"},
    "reporting.title": {"es": "Informes", "ca": "Informes"},
    "reporting.report_and_filters": {"es": "Informe y filtros", "ca": "Informe i filtres"},
    "reporting.report_type": {"es": "Informe", "ca": "Informe"},
    "reporting.graves": {"es": "Sepulturas", "ca": "Sepultures"},
    "reporting.contracts": {"es": "Contratos", "ca": "Contractes"},
    "reporting.debt": {"es": "Deuda", "ca": "Deute"},
    "reporting.grave_state": {"es": "Estado sepultura", "ca": "Estat sepultura"},
    "reporting.modality": {"es": "Modalidad", "ca": "Modalitat"},
    "reporting.block": {"es": "Bloque", "ca": "Bloc"},
    "reporting.contract_type": {"es": "Tipo contrato", "ca": "Tipus contracte"},
    "reporting.contract_validity": {"es": "Vigencia contrato", "ca": "Vig\u00e8ncia contracte"},
    "reporting.all": {"es": "Todas", "ca": "Totes"},
    "reporting.active": {"es": "VIGENTE", "ca": "VIGENT"},
    "reporting.expired": {"es": "VENCIDO", "ca": "VEN\u00c7UT"},
    "reporting.holder": {"es": "Titular", "ca": "Titular"},
    "reporting.contract_id_debt": {"es": "Contrato id (deuda)", "ca": "Contracte id (deute)"},
    "reporting.page_size": {"es": "Tama\u00f1o p\u00e1gina", "ca": "Mida p\u00e0gina"},
    "reporting.export_csv": {"es": "Exportar CSV", "ca": "Exportar CSV"},
    "reporting.results": {"es": "Resultados", "ca": "Resultats"},
    "reporting.pending_tickets": {"es": "Tickets pendientes", "ca": "Tiquets pendents"},
    "reporting.tickets_amount": {"es": "Importe tickets", "ca": "Import tiquets"},
    "reporting.unpaid_invoices": {"es": "Facturas impagadas", "ca": "Factures impagades"},
    "reporting.invoices_amount": {"es": "Importe facturas", "ca": "Import factures"},
    "reporting.total_debt": {"es": "Deuda total", "ca": "Deute total"},
    "module.pending_title": {"es": "M\u00f3dulo pendiente", "ca": "M\u00f2dul pendent"},
    "module.pending_description": {
        "es": "Este m\u00f3dulo no forma parte del alcance de la demo actual.",
        "ca": "Aquest m\u00f2dul no forma part de l'abast de la demo actual.",
    },
    "module.right_extension": {
        "es": "Ampliaci\u00f3n de derecho funerario",
        "ca": "Ampliaci\u00f3 de dret funerari",
    },
    "module.right_renewal": {
        "es": "Pr\u00f3rroga de derecho funerario",
        "ca": "Pr\u00f2rroga de dret funerari",
    },
    "demo.title": {"es": "Herramientas demo", "ca": "Eines demo"},
    "demo.checklist": {"es": "Checklist", "ca": "Checklist"},
    "demo.checklist_case": {
        "es": "Crear caso de transmisi\u00f3n de ejemplo",
        "ca": "Crear cas de transmissi\u00f3 d'exemple",
    },
    "demo.checklist_expediente": {
        "es": "Crear expediente de inhumaci\u00f3n de ejemplo",
        "ca": "Crear expedient d'inhumaci\u00f3 d'exemple",
    },
    "demo.checklist_tickets": {
        "es": "Generar tiquets del a\u00f1o actual",
        "ca": "Generar tiquets de l'any actual",
    },
    "demo.checklist_reset": {
        "es": "Reset de datos demo por organizaci\u00f3n (solo DEV)",
        "ca": "Reset de dades demo per organitzaci\u00f3 (nom\u00e9s DEV)",
    },
    "demo.create_case_example": {"es": "Crear caso ejemplo", "ca": "Crear cas exemple"},
    "demo.create_expediente_example": {
        "es": "Crear expediente ejemplo",
        "ca": "Crear expedient exemple",
    },
    "demo.generate_tickets_current_year": {
        "es": "Generar tiquets a\u00f1o actual",
        "ca": "Generar tiquets any actual",
    },
    "demo.reset_data": {"es": "Reset demo data", "ca": "Reset demo data"},
    "demo.explicit_confirmation": {"es": "Confirmaci\u00f3n expl\u00edcita", "ca": "Confirmaci\u00f3 expl\u00edcita"},
    "demo.reset_placeholder": {
        "es": "Escribe RESET-DEMO",
        "ca": "Escriu RESET-DEMO",
    },
    "demo.reset_button": {"es": "Reset por organizaci\u00f3n", "ca": "Reset per organitzaci\u00f3"},
    "error.403_title": {"es": "Acceso denegado", "ca": "Acc\u00e9s denegat"},
    "error.403_message": {
        "es": "No tienes permisos para realizar esta acci\u00f3n.",
        "ca": "No tens permisos per realitzar aquesta acci\u00f3.",
    },
    "error.404_title": {"es": "P\u00e1gina no encontrada", "ca": "P\u00e0gina no trobada"},
    "error.404_message": {
        "es": "La ruta solicitada no existe o no est\u00e1 disponible para tu organizaci\u00f3n.",
        "ca": "La ruta sol\u00b7licitada no existeix o no est\u00e0 disponible per a la teva organitzaci\u00f3.",
    },
    "person_picker.selected": {"es": "Seleccionado", "ca": "Seleccionat"},
    "person_picker.none_selected": {
        "es": "Sin persona seleccionada.",
        "ca": "Sense persona seleccionada.",
    },
    "person_picker.required_error": {
        "es": "Debes seleccionar o crear una persona.",
        "ca": "Has de seleccionar o crear una persona.",
    },
    "person_picker.search_placeholder": {
        "es": "Buscar por nombre, apellidos o DNI/NIF",
        "ca": "Cercar per nom, cognoms o DNI/NIF",
    },
    "person_picker.create_new": {"es": "Crear persona nueva", "ca": "Crear persona nova"},
    "person_picker.create_and_select": {"es": "Crear y seleccionar", "ca": "Crear i seleccionar"},
    "person_picker.created_selected": {
        "es": "Persona creada y seleccionada: {name}",
        "ca": "Persona creada i seleccionada: {name}",
    },
    "person_picker.action": {"es": "Acci\u00f3n", "ca": "Acci\u00f3"},
    "person_picker.select": {"es": "Seleccionar", "ca": "Seleccionar"},
    "person_picker.no_results_for": {
        "es": "Sin resultados para \"{query}\".",
        "ca": "Sense resultats per a \"{query}\".",
    },
    "person_picker.search_hint": {
        "es": "Escribe un criterio y pulsa buscar.",
        "ca": "Escriu un criteri i prem cercar.",
    },
    "state.lliure": {"es": "Lliure", "ca": "Lliure"},
    "state.disponible": {"es": "Disponible", "ca": "Disponible"},
    "state.ocupada": {"es": "Ocupada", "ca": "Ocupada"},
    "state.inactiva": {"es": "Inactiva", "ca": "Inactiva"},
    "state.propia": {"es": "Pr\u00f2pia", "ca": "Pr\u00f2pia"},
}


def get_locale() -> str:
    lang = session.get("lang", "es")
    if lang not in SUPPORTED_LANGS:
        return "es"
    return lang


def translate(key: str) -> str:
    lang = get_locale()
    return I18N.get(key, {}).get(lang, key)
